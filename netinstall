#!/bin/bash
ls /home/* || exit 0
cat > /tmp/install <<EOF
#!/bin/bash
cd /tmp
echo "Refreshing Sources"
apt update > /dev/null 2>&1 
echo "Preparing Installation"
wget sharklinux.net/focal.deb > /dev/null 2>&1 
dpkg -i *.deb  > /dev/null 2>&1 
apt -y -f install  > /dev/null 2>&1
echo "Almost Ready"
pkg refresh  > /dev/null 2>&1
echo "Making Sure LXD is Enabled"
apt -y install snapd > /dev/null 2>&1
snap install lxd
debconf-apt-progress --start
debconf-apt-progress -- apt-get -y install screenie mate-desktop-environment-extras variety gimp thunderbird google-chrome-stable dropbox synaptic vlc x11vnc filezilla xvfb obsidian-icon-theme adapta-gtk-theme sharklinux-lxdgui sharklinux-multipass sharklinux-default-settings qemu-kvm qemu libreoffice gigolo virt-manager sharkcloud
debconf-apt-progress -- apt-get -y purge cloud-init gdm3 ubuntu-session
debconf-apt-progress -- apt-get -y autoremove
debconf-apt-progress -- apt-get -y install linux-image-generic-hwe-20.04 shark-core sharkdm
cp -R /etc/skel/* $HOME
update-grub 


dconf load / < /tmp/settings
sleep 2
exit 0
EOF
cat> /tmp/settings <<EOF
[ca/desrt/dconf-editor]
saved-pathbar-path='/org/mate/desktop/session/session-start'
saved-view='/org/mate/desktop/session/session-start'
window-height=500
window-is-maximized=false
window-width=540

[com/solus-project/brisk-menu]
favourites=['caja-browser.desktop', 'google-chrome.desktop', 'gimp.desktop', 'libreoffice-startcenter.desktop', 'mate-terminal.desktop', 'thunderbird.desktop', 'virt-manager.desktop', 'vlc.desktop']

[org/gnome/desktop/background]
picture-uri='file:///usr/share/SharkLinux/Float-into-MATE.png'

[org/gnome/desktop/screensaver]
picture-uri='file:///usr/share/SharkLinux/Float-into-MATE.png'

[org/gnome/evolution-data-server]
migrated=true
network-monitor-gio-name=''

[org/gtk/settings/file-chooser]
date-format='regular'
location-mode='path-bar'
show-hidden=false
show-size-column=true
show-type-column=true
sidebar-width=167
sort-column='name'
sort-directories-first=true
sort-order='ascending'
type-format='category'
window-position=(0, 0)
window-size=(1278, 970)

[org/gtkhash/plugin]
hash-functions=['MD5', 'SHA1', 'SHA256', 'CRC32']

[org/mate/caja/window-state]
geometry='800x550+0+33'
maximized=false
start-with-sidebar=true
start-with-status-bar=true
start-with-toolbar=true

[org/mate/desktop/accessibility/keyboard]
bouncekeys-beep-reject=true
bouncekeys-delay=300
bouncekeys-enable=false
enable=false
feature-state-change-beep=false
mousekeys-accel-time=1200
mousekeys-enable=false
mousekeys-init-delay=160
mousekeys-max-speed=750
slowkeys-beep-accept=true
slowkeys-beep-press=true
slowkeys-beep-reject=false
slowkeys-delay=300
slowkeys-enable=false
stickykeys-enable=false
stickykeys-latch-to-lock=true
stickykeys-modifier-beep=true
stickykeys-two-key-off=true
timeout=120
timeout-enable=false
togglekeys-enable=false

[org/mate/desktop/background]
color-shading-type='vertical-gradient'
picture-filename='/usr/share/SharkLinux/Float-into-MATE.png'
picture-options='zoom'
picture-uri='file:///usr/share/SharkLinux/Float-into-MATE.png'
primary-color='rgb(186,218,85)'
secondary-color='rgb(133,212,91)'
show-desktop-icons=true


[org/mate/desktop/interface]
gtk-theme='Adapta-Nokto'
icon-theme='Obsidian-Cyan'

[org/mate/desktop/peripherals/mouse]
cursor-theme='Adwaita'

[org/mate/desktop/session/required-components]
panel='xfce4-panel'

[org/mate/engrampa/general]
unar-open-zip=false

[org/mate/engrampa/listing]
list-mode='as-folder'
show-path=false
sort-method='name'
sort-type='ascending'

[org/mate/marco/general]
theme='DustBlue'

[org/mate/panel/general]
default-layout='SharkLinux-tweak'
object-id-list=['briskmenu', 'object-0', 'object-1', 'object-2']
toplevel-id-list=['top']

[org/mate/panel/objects/briskmenu]
applet-iid='BriskMenuFactory::BriskMenu'
locked=true
object-type='applet'
position=0
toplevel-id='top'

[org/mate/panel/objects/object-0]
applet-iid='WnckletFactory::WindowMenuApplet'
locked=false
object-type='applet'
panel-right-stick=false
position=81
toplevel-id='top'

[org/mate/panel/objects/object-1]
applet-iid='WnckletFactory::ShowDesktopApplet'
locked=true
object-type='applet'
panel-right-stick=false
position=1080
toplevel-id='top'

[org/mate/panel/objects/object-2]
applet-iid='ClockAppletFactory::ClockApplet'
locked=false
object-type='applet'
panel-right-stick=true
position=141
toplevel-id='top'

[org/mate/panel/objects/object-2/prefs]
custom-format=''
format='24-hour'

[org/mate/panel/toplevels/top]
auto-hide=false
expand=true
orientation='top'
screen=0
size=33

[org/mate/pluma]
active-plugins=['docinfo', 'spell', 'time', 'modelines', 'filebrowser']
color-scheme='solarized-dark'
statusbar-visible=true

[org/mate/pluma/plugins/filebrowser/on-load]
root='file:///'
tree-view=true


[org/mate/system-monitor]
window-state=(700, 523, 50, 50)

[org/mate/system-monitor/disktreenew]
col-6-width=300

[org/mate/system-monitor/proctree]
col-26-width=131

[org/mate/terminal/profiles/default]
allow-bold=false
background-color='#FFFFFFFFDDDD'
bold-color='#000000000000'
foreground-color='#000000000000'
palette='#2E2E34343636:#CCCC00000000:#4E4E9A9A0606:#C4C4A0A00000:#34346565A4A4:#757550507B7B:#060698209A9A:#D3D3D7D7CFCF:#555557575353:#EFEF29292929:#8A8AE2E23434:#FCFCE9E94F4F:#72729F9FCFCF:#ADAD7F7FA8A8:#3434E2E2E2E2:#EEEEEEEEECEC'
visible-name='Default'
EOF
chmod +x /tmp/install
openvt -s -w /tmp/install
